
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ğŸ“‹ GESTION COMPLÃˆTE DES FACTURES - ADMIN CONFIGURÃ‰ âœ…           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ NOUVELLES FONCTIONNALITÃ‰S ADMIN
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Gestion des factures (Ventes)
   â€¢ Visualiser toutes les factures
   â€¢ Modifier une facture existante
   â€¢ Supprimer une facture
   â€¢ Filtrer par date et mode de paiement
   â€¢ Voir les dÃ©tails complets

âœ… AmÃ©lioration des PDF (ReÃ§us)
   â€¢ Logo personnalisÃ© sur les reÃ§us
   â€¢ Couleurs configurables (primaire/secondaire)
   â€¢ Design professionnel et moderne
   â€¢ Affichage dual currency (FC + USD)
   â€¢ Informations entreprise complÃ¨tes
   â€¢ Taux de change affichÃ©

âœ… Upload de logo
   â€¢ Interface dans ParamÃ¨tres > Entreprise
   â€¢ Formats acceptÃ©s : JPG, PNG, GIF, SVG
   â€¢ Taille max : 5MB
   â€¢ AperÃ§u en temps rÃ©el
   â€¢ Suppression possible


ğŸ“‚ PAGES AJOUTÃ‰ES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ Page Gestion des Factures
   URL : http://localhost:3000/invoices
   AccÃ¨s : Admin uniquement
   
   FonctionnalitÃ©s :
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ” Filtres de recherche                 â”‚
   â”‚   â€¢ Date de dÃ©but / fin                 â”‚
   â”‚   â€¢ Mode de paiement                    â”‚
   â”‚                                         â”‚
   â”‚ ğŸ“Š Tableau des factures                 â”‚
   â”‚   â€¢ NÂ° facture                          â”‚
   â”‚   â€¢ Date et heure                       â”‚
   â”‚   â€¢ Nom du caissier                     â”‚
   â”‚   â€¢ Montant total, remise, net Ã  payer  â”‚
   â”‚   â€¢ Mode de paiement                    â”‚
   â”‚                                         â”‚
   â”‚ ğŸ”§ Actions sur chaque facture          â”‚
   â”‚   ğŸ‘ï¸ Voir dÃ©tails complets             â”‚
   â”‚   âœï¸ Modifier la facture                â”‚
   â”‚   ğŸ“¥ TÃ©lÃ©charger PDF                    â”‚
   â”‚   ğŸ—‘ï¸ Supprimer (avec confirmation)     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2ï¸âƒ£ Page Modification de Facture
   URL : http://localhost:3000/edit-invoice/:id
   AccÃ¨s : Admin uniquement
   
   FonctionnalitÃ©s :
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ“‹ Informations facture                 â”‚
   â”‚   â€¢ Date de crÃ©ation                    â”‚
   â”‚   â€¢ Nom du caissier                     â”‚
   â”‚   â€¢ Mode de paiement                    â”‚
   â”‚   â€¢ Total original                      â”‚
   â”‚                                         â”‚
   â”‚ ğŸ›ï¸ Modification articles                â”‚
   â”‚   â€¢ Ajouter des produits                â”‚
   â”‚   â€¢ Modifier quantitÃ©s                  â”‚
   â”‚   â€¢ Retirer des articles                â”‚
   â”‚                                         â”‚
   â”‚ ğŸ’° Ajustements                          â”‚
   â”‚   â€¢ Modifier remise                     â”‚
   â”‚   â€¢ Ajouter/modifier notes              â”‚
   â”‚   â€¢ Changer client                      â”‚
   â”‚                                         â”‚
   â”‚ ğŸ’± Calculs automatiques                 â”‚
   â”‚   â€¢ Sous-total mis Ã  jour               â”‚
   â”‚   â€¢ Total en FC + Ã©quivalent USD        â”‚
   â”‚   â€¢ Restauration du stock               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3ï¸âƒ£ ParamÃ¨tres - Section Logo
   URL : http://localhost:3000/settings
   Onglet : Entreprise
   
   Interface d'upload :
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ–¼ï¸ AperÃ§u du logo                       â”‚
   â”‚   [          Logo actuel         ]      â”‚
   â”‚                                         â”‚
   â”‚ ğŸ“¤ Upload                               â”‚
   â”‚   [ Choisir un logo ]                   â”‚
   â”‚   [ Supprimer      ]                    â”‚
   â”‚                                         â”‚
   â”‚ â„¹ï¸ Info : JPG, PNG, GIF, SVG (5MB max) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ğŸ”§ API ROUTES AJOUTÃ‰ES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Gestion des factures :
  DELETE /api/sales/:id
    â†’ Supprimer une facture (admin uniquement)
    â†’ Restaure automatiquement le stock
    â†’ Supprime sale, sale_items, payments

  PUT /api/sales/:id
    â†’ Modifier une facture (admin uniquement)
    â†’ Restaure ancien stock
    â†’ Met Ã  jour avec nouveaux items
    â†’ Recalcule totaux

Upload de logo :
  POST /api/settings/upload-logo
    â†’ Upload fichier logo (admin uniquement)
    â†’ Sauvegarde dans /public/uploads/
    â†’ Met Ã  jour settings.logo
    â†’ Supprime ancien logo

  DELETE /api/settings/logo
    â†’ Supprimer le logo (admin uniquement)
    â†’ Supprime fichier physique
    â†’ Met Ã  jour settings


ğŸ“„ PDF AMÃ‰LIORÃ‰ (ReÃ§us)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Nouveau design professionnel :

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Logo]                                 â”‚
â”‚                                         â”‚
â”‚        REÃ‡U DE VENTE                    â”‚
â”‚                                         â”‚
â”‚        Mon Commerce                     â”‚
â”‚    Kinshasa, RDC                        â”‚
â”‚  TÃ©l: +243 XX XX XX XX                  â”‚
â”‚  Email: contact@moncommerce.cd          â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  NÂ° de vente: 15    Date: 08/11/2025    â”‚
â”‚  Client ID: 3       Note: Urgent        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Article   QtÃ©  P.U.      Total        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Coca      2    500 FC    1 000 FC     â”‚
â”‚  Pain      3    200 FC    600 FC       â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚          Sous-total:      1 600 FC      â”‚
â”‚          Remise:          -100 FC       â”‚
â”‚          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚          TOTAL:           1 500 FC      â”‚
â”‚          Ã‰quivalent:      0.60 $        â”‚
â”‚          (Taux: 1 $ = 2500 FC)          â”‚
â”‚                                         â”‚
â”‚  Mode de paiement: EspÃ¨ces              â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚       Merci de votre visite!            â”‚
â”‚            Ã€ bientÃ´t!                   â”‚
â”‚                                         â”‚
â”‚  ImprimÃ© le 08/11/2025 14:30 | Page 1   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CaractÃ©ristiques :
  â€¢ Logo en haut (si uploadÃ©)
  â€¢ Couleurs personnalisables
  â€¢ Lignes alternÃ©es pour lisibilitÃ©
  â€¢ Dual currency (FC + USD)
  â€¢ Taux de change affichÃ©
  â€¢ Informations entreprise complÃ¨tes
  â€¢ Footer avec date d'impression


ğŸ” PERMISSIONS & SÃ‰CURITÃ‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

AccÃ¨s restreint ADMIN uniquement :
  âœ“ Voir toutes les factures
  âœ“ Modifier n'importe quelle facture
  âœ“ Supprimer des factures
  âœ“ Uploader/supprimer logo

Managers & Caissiers :
  âœ— Pas d'accÃ¨s Ã  /invoices
  âœ— Pas d'accÃ¨s Ã  /edit-invoice
  âœ“ Peuvent crÃ©er des ventes (POS)
  âœ“ Peuvent voir leurs propres ventes

SÃ©curitÃ© :
  â€¢ VÃ©rification du rÃ´le cÃ´tÃ© serveur
  â€¢ Restauration automatique du stock
  â€¢ Transactions SQL (rollback si erreur)
  â€¢ Validation des fichiers uploadÃ©s


ğŸ”„ WORKFLOW MODIFICATION FACTURE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ Admin ouvre /invoices
   â†’ Liste toutes les factures

2ï¸âƒ£ Clic sur "Modifier" (âœï¸)
   â†’ Ouvre /edit-invoice/:id

3ï¸âƒ£ Page de modification
   â†’ Charge facture existante
   â†’ Affiche articles actuels
   â†’ Charge liste des produits disponibles

4ï¸âƒ£ Modifications possibles
   â†’ Ajouter/retirer articles
   â†’ Changer quantitÃ©s
   â†’ Modifier remise
   â†’ Changer client
   â†’ Ajouter notes

5ï¸âƒ£ Sauvegarde
   â†’ PUT /api/sales/:id
   â†’ Restaure ancien stock
   â†’ DÃ©duit nouveau stock
   â†’ Met Ã  jour sale, sale_items, payments
   â†’ Recalcule totaux

6ï¸âƒ£ Confirmation
   â†’ Message de succÃ¨s
   â†’ Retour Ã  /invoices


ğŸ—‘ï¸ WORKFLOW SUPPRESSION FACTURE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ Admin ouvre /invoices
   â†’ Liste toutes les factures

2ï¸âƒ£ Clic sur "Supprimer" (ğŸ—‘ï¸)
   â†’ Modal de confirmation

3ï¸âƒ£ Confirmation
   â†’ "ÃŠtes-vous sÃ»r ?"
   â†’ Action irrÃ©versible

4ï¸âƒ£ Suppression
   â†’ DELETE /api/sales/:id
   â†’ Restaure le stock des produits
   â†’ Supprime sale_items
   â†’ Supprime payments
   â†’ Supprime sale

5ï¸âƒ£ Confirmation
   â†’ Message de succÃ¨s
   â†’ Liste actualisÃ©e


ğŸ“¤ WORKFLOW UPLOAD LOGO
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ Admin ouvre /settings
   â†’ Onglet "Entreprise"

2ï¸âƒ£ Section Logo
   â†’ AperÃ§u logo actuel (si existe)
   â†’ Bouton "Choisir un logo"

3ï¸âƒ£ SÃ©lection fichier
   â†’ JPG, PNG, GIF ou SVG
   â†’ Max 5MB

4ï¸âƒ£ Upload
   â†’ POST /api/settings/upload-logo
   â†’ Sauvegarde dans /public/uploads/
   â†’ Supprime ancien logo
   â†’ Met Ã  jour settings.logo

5ï¸âƒ£ Confirmation
   â†’ AperÃ§u mis Ã  jour
   â†’ Bouton "Supprimer" visible
   â†’ Logo disponible sur tous les reÃ§us


ğŸ’¡ AMÃ‰LIORATIONS APPORTÃ‰ES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… FlexibilitÃ©
   Admin peut corriger erreurs de saisie
   Modification complÃ¨te des factures
   Suppression si besoin

âœ… TraÃ§abilitÃ©
   Historique des factures
   Filtres par date/paiement
   DÃ©tails complets accessibles

âœ… Professionnalisme
   Logo sur reÃ§us
   Design moderne et colorÃ©
   Dual currency (FC/USD)
   Informations complÃ¨tes

âœ… Gestion du stock
   Restauration automatique
   Pas de dÃ©calage en cas de modif/suppression
   Transactions sÃ©curisÃ©es

âœ… Interface intuitive
   Boutons d'action clairs
   Modals de confirmation
   Messages d'erreur explicites
   Design responsive


ğŸ“‚ FICHIERS CRÃ‰Ã‰S/MODIFIÃ‰S
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Nouveaux fichiers :
  ğŸ“„ views/invoices.ejs          â†’ Page liste factures
  ğŸ“„ views/edit-invoice.ejs      â†’ Page modification facture
  ğŸ“ public/uploads/             â†’ Dossier pour logos

Fichiers modifiÃ©s :
  ğŸ“ routes/sales.js             â†’ Routes DELETE et PUT
  ğŸ“ routes/settings.js          â†’ Routes upload logo
  ğŸ“ utils/receipt.js            â†’ PDF amÃ©liorÃ© avec logo
  ğŸ“ views/settings.ejs          â†’ Section upload logo
  ğŸ“ server.js                   â†’ Routes /invoices et /edit-invoice
  ğŸ“ package.json                â†’ Ajout de multer

Nouvelles dÃ©pendances :
  ğŸ“¦ multer                      â†’ Upload de fichiers


ğŸ§ª TESTS RECOMMANDÃ‰S
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. CrÃ©er quelques ventes
   âœ“ Via POS
   âœ“ DiffÃ©rents produits
   âœ“ DiffÃ©rentes remises

2. Tester page /invoices
   âœ“ Liste affichÃ©e correctement
   âœ“ Filtres fonctionnent
   âœ“ DÃ©tails s'affichent

3. Modifier une facture
   âœ“ Ouvrir /edit-invoice/:id
   âœ“ Ajouter/retirer articles
   âœ“ Modifier remise
   âœ“ Sauvegarder
   âœ“ VÃ©rifier stock restaurÃ©

4. Supprimer une facture
   âœ“ Confirmer suppression
   âœ“ VÃ©rifier stock restaurÃ©
   âœ“ VÃ©rifier disparition

5. Upload logo
   âœ“ Uploader logo dans /settings
   âœ“ VÃ©rifier aperÃ§u
   âœ“ TÃ©lÃ©charger PDF avec logo
   âœ“ Supprimer logo
   âœ“ VÃ©rifier PDF sans logo

6. Tester PDF amÃ©liorÃ©
   âœ“ TÃ©lÃ©charger reÃ§u
   âœ“ VÃ©rifier logo prÃ©sent
   âœ“ VÃ©rifier couleurs
   âœ“ VÃ©rifier dual currency
   âœ“ VÃ©rifier infos complÃ¨tes


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              âœ… GESTION COMPLÃˆTE DES FACTURES ADMIN                  â•‘
â•‘                                                                      â•‘
â•‘  ğŸ“‹ Visualiser toutes les factures                                  â•‘
â•‘  âœï¸ Modifier n'importe quelle facture                               â•‘
â•‘  ğŸ—‘ï¸ Supprimer des factures (avec restauration stock)               â•‘
â•‘  ğŸ–¼ï¸ Upload logo personnalisÃ©                                        â•‘
â•‘  ğŸ“„ PDF amÃ©liorÃ©s avec logo + couleurs + dual currency              â•‘
â•‘  ğŸ’± Affichage FC + USD sur tous les reÃ§us                           â•‘
â•‘  ğŸ” AccÃ¨s rÃ©servÃ© aux admins                                        â•‘
â•‘                                                                      â•‘
â•‘  ğŸ‡¨ğŸ‡© Parfait pour la gestion complÃ¨te en RDC                        â•‘
â•‘                                                                      â•‘
â•‘  ğŸ‘‰ Page factures : http://localhost:3000/invoices                  â•‘
â•‘  ğŸ‘‰ ParamÃ¨tres : http://localhost:3000/settings                     â•‘
â•‘     Login : admin / admin123                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
